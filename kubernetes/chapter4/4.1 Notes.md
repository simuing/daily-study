# 4장 애플리케이션의 설정을 체계적으로 관리하기

소프트웨어를 개발하고 배포하는 환경이 다양하고 복잡해지면서 일반적으로 설정은 소프트웨어의 내부보다는 외부에 있는 것이 유리하다. 이를 외부화된 설정(externalized configuration)이라고 한다.

이렇게 설정을 관리할 때 보안에 민감한 설정값들은 조금 더 신경 써서 관리해야 한다. 이런 값들은 소스코드에 포함하지 않고, 애플리케이션의 배포 이후에 환경 변수 등을 이용해 수동으로 설정해 주거나 데이터를 안전하게 보관해주는 별도의 KMS(key management service)를 연결해서 사용하는 방법 등을 사용할 수 있다.

쿠버네티스는 설정 관리를 도와주기 위한 오브젝트인 컨피그맵(ConfigMap)과 시크릿(Secret)을 제공한다.

## 4.1 환경 변수와 실행 인자

#### 네임스페이스의 사용법

하나의 쿠버네티스 클러스터에 다양한 환경을 구성해서 사용하고 싶을 때는 네임스페이스(namespace)를 사용하는 것이 편하다. 네임스페이스는 클러스터에서 오브젝트를 논리적으로 구분해 주는 단위이다.

네임스페이스 명세 파일을 정의해서 적용하거나 다음과 같이 `kubectl`을 이용해 간단히 생성할 수 있다.
```
$ kubectl create namespace prod
namespace/prod created
```

생성한 네임스페이스에 속하는 오브젝트를 구분하기 위해서 다음과 같이 명세 파일의 `metadata`에 네임스페이스를 정의할 수 있다.

```yaml
# /chapter4/my-pod-prod.yaml
apiVersion: v1
kind: Pod
metadata:
  name: my-pod-prod
  namespace: prod
spec:
  containers:
    - name: my-app
      image: my-app:1.0.0
      ports:
      - containerPort: 3000
```

또한 `kubectl` 명령어를 사용할 때도 다음과 같이 네임스페이스를 인자로 전달하여 구분해줄 수 있다.
```
$ kubectl --namespace=prod get pod
NAME          READY   STATUS    RESTARTS   AGE
my-pod-prod   1/1     Running   0          71s
```